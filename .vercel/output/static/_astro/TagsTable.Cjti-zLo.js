import{j as r}from"./jsx-runtime.D_zvdyIk.js";import{r as h}from"./index.DMVOjPfi.js";import{D as w}from"./DataTable.BW11Mfvz.js";import{B as g}from"./Badge.BMvICgvW.js";import"./utils.CBfrqCZ4.js";import"./Input.BNCvmRV-.js";import"./index.3rXK4OIH.js";async function y(s,n){if(n>0){alert(`Tag ini digunakan di ${n} artikel. Hapus tag dari artikel terlebih dahulu sebelum menghapus tag.`);return}if(confirm("Apakah Anda yakin ingin menghapus tag ini?"))try{const i=await fetch(`/api/tags/${s}`,{method:"DELETE",credentials:"include"});if(i.ok)alert("Tag berhasil dihapus"),window.location.reload();else{const t=await i.json();alert("Error: "+(t.error||"Gagal menghapus tag"))}}catch{alert("Error: Gagal menghapus tag")}}async function j(s,n){const i=s.filter(t=>(n[t]||0)>0);if(i.length>0){const t=i.map(l=>`Tag ID ${l}`).join(", ");alert(`Beberapa tag masih digunakan di artikel: ${t}. Hapus tag dari artikel terlebih dahulu sebelum menghapus.`);return}try{const t=s.map(o=>fetch(`/api/tags/${o}`,{method:"DELETE",credentials:"include"})),c=(await Promise.all(t)).filter(o=>!o.ok);c.length===0?(alert(`${s.length} tag berhasil dihapus`),window.location.reload()):alert(`${c.length} dari ${s.length} tag gagal dihapus`)}catch{alert("Error: Gagal menghapus tags")}}function $({tags:s,tagUsage:n,onDelete:i,currentPage:t,totalPages:l,totalItems:c,itemsPerPage:o,paginationBaseUrl:u,initialSearch:v=""}){const m=h.useMemo(()=>{try{return JSON.parse(s||"[]")}catch{return[]}},[s]),d=h.useMemo(()=>{try{return JSON.parse(n||"{}")}catch{return{}}},[n]),p=[{id:"name",header:"Name",accessorKey:"name",sortable:!0,cell:e=>r.jsx("div",{className:"font-semibold text-gray-900",children:e.name})},{id:"slug",header:"Slug",accessorKey:"slug",sortable:!0,cell:e=>r.jsx(g,{variant:"secondary",className:"font-mono text-xs",children:e.slug})},{id:"description",header:"Description",accessorKey:"description",cell:e=>r.jsx("div",{className:"text-sm text-gray-600 max-w-md truncate",children:e.description||"-"})},{id:"usage",header:"Usage",sortable:!0,cell:e=>{const a=d[e.id]||0;return r.jsxs(g,{variant:a>0?"default":"secondary",className:a>0?"bg-blue-100 text-blue-700":"",children:[a," artikel"]})}},{id:"created_at",header:"Created",accessorKey:"created_at",sortable:!0,cell:e=>r.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString("id-ID")})}],f=e=>{const a=d[e.id]||0;return[{label:"Edit",onClick:()=>{window.location.href=`/dashboard/tags/${e.id}/edit`},icon:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{label:"Delete",onClick:()=>{y(e.id,a)},icon:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}]},x=async e=>{const a=e.map(b=>b.id);await j(a,d)},k=e=>{if(u){const a=new URL(window.location.href);e?a.searchParams.set("search",e):a.searchParams.delete("search"),a.searchParams.set("page","1"),window.location.href=a.toString()}};return r.jsx(w,{data:m,columns:p,enableSelection:!0,actionMenuItems:f,onMassDelete:x,getRowId:e=>e.id,onSearch:k,searchPlaceholder:"Filter tags...",emptyMessage:"Belum ada tags. Buat tag pertama untuk memulai.",defaultSort:{key:"created_at",direction:"desc"},currentPage:t,totalPages:l,totalItems:c,itemsPerPage:o,paginationBaseUrl:u})}export{$ as default};
