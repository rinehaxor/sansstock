import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as d}from"./index.DMVOjPfi.js";import{c as m}from"./utils.CBfrqCZ4.js";import{I as ae}from"./Input.BNCvmRV-.js";const W=d.forwardRef(({className:n,...o},c)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:c,className:m("w-full caption-bottom text-sm rounded-lg",n),...o})}));W.displayName="Table";const _=d.forwardRef(({className:n,...o},c)=>e.jsx("thead",{ref:c,className:m("[&_tr]:border-b bg-gray-50",n),...o}));_.displayName="TableHeader";const B=d.forwardRef(({className:n,...o},c)=>e.jsx("tbody",{ref:c,className:m("[&_tr:last-child]:border-0",n),...o}));B.displayName="TableBody";const ne=d.forwardRef(({className:n,...o},c)=>e.jsx("tfoot",{ref:c,className:m("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...o}));ne.displayName="TableFooter";const R=d.forwardRef(({className:n,...o},c)=>e.jsx("tr",{ref:c,className:m("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...o}));R.displayName="TableRow";const T=d.forwardRef(({className:n,...o},c)=>e.jsx("th",{ref:c,className:m("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",n),...o}));T.displayName="TableHead";const N=d.forwardRef(({className:n,...o},c)=>e.jsx("td",{ref:c,className:m("p-4 align-middle [&:has([role=checkbox])]:pr-0",n),...o}));N.displayName="TableCell";const oe=d.forwardRef(({className:n,...o},c)=>e.jsx("caption",{ref:c,className:m("mt-4 text-sm text-muted-foreground",n),...o}));oe.displayName="TableCaption";function fe({data:n,columns:o,searchKey:c,searchPlaceholder:I="Filter...",onSearch:L,actions:y,actionMenuItems:w,emptyMessage:O="No data available.",className:q,enableSelection:k=!1,onSelectionChange:C,onMassDelete:M,getRowId:le,currentPage:i,totalPages:f,totalItems:z,itemsPerPage:A,onPageChange:ie,paginationBaseUrl:b,buildPaginationUrl:g,defaultSort:D}){const G=()=>typeof window<"u"&&new URLSearchParams(window.location.search).get("search")||"",[x,E]=d.useState(G()),[u,S]=d.useState(new Set),[p,J]=d.useState(D?{key:D.key,direction:D.direction}:{key:null,direction:null}),[j,$]=d.useState(null),[F,H]=d.useState(!1),V=d.useRef(new Map);d.useEffect(()=>{if(typeof window<"u"){const r=()=>{const t=new URLSearchParams(window.location.search).get("search")||"";E(t)};return r(),window.addEventListener("popstate",r),()=>window.removeEventListener("popstate",r)}},[]),d.useEffect(()=>{if(j===null)return;function r(t){const l=t.target,a=j;if(a===null)return;const h=V.current.get(a);h&&!h.contains(l)&&$(null)}const s=setTimeout(()=>{document.addEventListener("click",r)},0);return()=>{clearTimeout(s),document.removeEventListener("click",r)}},[j]);const Q=r=>{const s=r.target.value;E(s),L?.(s)},X=r=>{if(r.preventDefault(),g)window.location.href=g(1,x);else if(b){const s=new URLSearchParams;x&&s.set("search",x),s.set("page","1"),window.location.href=`${b}?${s.toString()}`}},Y=()=>{E(""),g?window.location.href=g(1):b&&(window.location.href=`${b}?page=1`),L?.("")},Z=r=>{if(r){const s=new Set(n.map((t,l)=>l));S(s),C?.(n)}else S(new Set),C?.([])},U=(r,s)=>{const t=new Set(u);s?t.add(r):t.delete(r),S(t);const l=Array.from(t).map(a=>n[a]);C?.(l)},P=async()=>{if(u.size===0)return;const r=Array.from(u).map(t=>n[t]),s=r.length;if(confirm(`Apakah Anda yakin ingin menghapus ${s} item yang dipilih?`)){H(!0);try{M&&await M(r),S(new Set),C?.([])}catch(t){console.error("Error deleting items:",t),alert("Terjadi error saat menghapus item. Silakan coba lagi.")}finally{H(!1)}}},ee=r=>{const s=o.find(t=>t.id===r);!s||!s.sortable||J(t=>{if(t.key===r){if(t.direction==="asc")return{key:r,direction:"desc"};if(t.direction==="desc")return{key:null,direction:null}}return{key:r,direction:"asc"}})},re=n.length>0&&u.size===n.length,te=u.size>0&&u.size<n.length,K=d.useMemo(()=>{if(!p.key||!p.direction)return n;const r=o.find(t=>t.id===p.key);return!r||!r.sortable?n:[...n].sort((t,l)=>{let a,h;return r.accessorKey?(a=t[r.accessorKey],h=l[r.accessorKey]):(a=t[p.key],h=l[p.key]),a==null&&h==null?0:a==null?1:h==null?-1:((a instanceof Date||typeof a=="string"&&a.match(/^\d{4}-\d{2}-\d{2}/))&&(a=new Date(a).getTime(),h=new Date(h).getTime()),typeof a=="string"&&typeof h=="string"?p.direction==="asc"?a.localeCompare(h):h.localeCompare(a):p.direction==="asc"?a<h?-1:a>h?1:0:a>h?-1:a<h?1:0)})},[n,p,o]),v=r=>{if(g)return g(r,x);if(b){const s=new URLSearchParams;return x&&s.set("search",x),s.set("page",r.toString()),`${b}?${s.toString()}`}return`?page=${r}${x?`&search=${encodeURIComponent(x)}`:""}`},se=()=>{if(!f||!i)return null;const r=[],s=5;let t=Math.max(1,i-Math.floor(s/2)),l=Math.min(f,t+s-1);l-t<s-1&&(t=Math.max(1,l-s+1)),t>1&&(r.push(e.jsx("a",{href:v(1),className:m("inline-flex items-center justify-center px-3 py-2 text-sm font-medium border rounded-lg transition-colors",i===1?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:"1"},"1")),t>2&&r.push(e.jsx("span",{className:"px-3 py-2 text-gray-500",children:"..."},"ellipsis-start")));for(let a=t;a<=l;a++)r.push(e.jsx("a",{href:v(a),className:m("inline-flex items-center justify-center px-3 py-2 text-sm font-medium border rounded-lg transition-colors",i===a?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:a},a));return l<f&&(l<f-1&&r.push(e.jsx("span",{className:"px-3 py-2 text-gray-500",children:"..."},"ellipsis-end")),r.push(e.jsx("a",{href:v(f),className:m("inline-flex items-center justify-center px-3 py-2 text-sm font-medium border rounded-lg transition-colors",i===f?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:f},f))),r};return e.jsxs("div",{className:m("space-y-4",q),children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[(c||L)&&e.jsx("form",{onSubmit:X,className:"flex-1 max-w-sm",children:e.jsxs("div",{className:"relative",children:[e.jsx(ae,{type:"text",placeholder:I,value:x,onChange:Q,className:"w-full pr-10"}),x&&e.jsx("button",{type:"button",onClick:Y,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Clear search",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Search",style:{right:x?"2.5rem":"0.5rem"},children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),e.jsx("div",{className:"flex items-center gap-2",children:k&&u.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[u.size," item dipilih"]}),M&&e.jsx("button",{onClick:P,disabled:F,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:F?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Menghapus..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Hapus ",u.size," item"]})})]})})]}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:e.jsxs(W,{children:[e.jsx(_,{className:"rounded-t-xl",children:e.jsxs(R,{className:"hover:bg-gray-50/50 border-b border-gray-200",children:[k&&e.jsx(T,{className:"w-12",children:e.jsx("input",{type:"checkbox",checked:re,ref:r=>{r&&(r.indeterminate=te)},onChange:r=>Z(r.target.checked),className:"h-4 w-4 rounded-md border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"})}),o.map(r=>e.jsx(T,{className:m(r.className,r.sortable&&"cursor-pointer select-none hover:bg-gray-100"),onClick:()=>r.sortable&&ee(r.id),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:r.header}),r.sortable&&p.key===r.id&&e.jsx("span",{className:"text-gray-400",children:p.direction==="asc"?"↑":p.direction==="desc"?"↓":""})]})},r.id)),(y||w)&&e.jsx(T,{className:"w-[100px] text-right",children:"Actions"})]})}),e.jsx(B,{children:K.length===0?e.jsx(R,{children:e.jsx(N,{colSpan:o.length+(k?1:0)+(y||w?1:0),className:"h-24 text-center",children:O})}):K.map((r,s)=>e.jsxs(R,{className:m("hover:bg-gray-50/50 transition-colors",u.has(s)&&"bg-blue-50"),children:[k&&e.jsx(N,{children:e.jsx("input",{type:"checkbox",checked:u.has(s),onChange:t=>U(s,t.target.checked),className:"h-4 w-4 rounded-md border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"})}),o.map(t=>{let l;return t.cell?l=t.cell(r):t.accessorKey?l=r[t.accessorKey]:l=null,e.jsx(N,{className:t.className,children:l},t.id)}),(y||w)&&e.jsx(N,{className:"text-right",children:y?y(r):w?e.jsxs("div",{className:"relative inline-block",ref:t=>{t?V.current.set(s,t):V.current.delete(s)},children:[e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),$(j===s?null:s)},className:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),j===s&&e.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50 py-1",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase border-b border-gray-100",children:"Actions"}),w(r).map((t,l)=>e.jsxs("button",{type:"button",onClick:a=>{a.preventDefault(),a.stopPropagation(),$(null),t.onClick()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 text-left transition-colors rounded-md mx-1",children:[t.icon,e.jsx("span",{children:t.label})]},l))]})]}):null})]},s))})]})}),f&&f>1&&i&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("nav",{className:"flex items-center justify-center gap-2","aria-label":"Pagination",children:[e.jsx("a",{href:i>1?g?g(i-1,x):v(i-1):"#",className:m("inline-flex items-center justify-center px-4 py-2 text-sm font-medium border rounded-lg transition-colors",i<=1?"bg-gray-100 text-gray-400 border-gray-300 cursor-not-allowed pointer-events-none":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),"aria-disabled":i<=1,children:"Previous"}),se(),e.jsx("a",{href:i<f?g?g(i+1,x):v(i+1):"#",className:m("inline-flex items-center justify-center px-4 py-2 text-sm font-medium border rounded-lg transition-colors",i>=f?"bg-gray-100 text-gray-400 border-gray-300 cursor-not-allowed pointer-events-none":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),"aria-disabled":i>=f,children:"Next"})]}),z&&A&&e.jsxs("div",{className:"mt-4 text-sm text-gray-600 text-center",children:["Menampilkan ",(i-1)*A+1," sampai ",Math.min(i*A,z)," dari ",z," item"]})]})]})}export{fe as D};
