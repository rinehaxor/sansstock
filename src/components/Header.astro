---
// Header component untuk blog berita ekonomi dan saham
import { Image } from 'astro:assets';
import logo from '../assets/logo.png';
---

<header class="bg-white/95 backdrop-blur-md border-b border-gray-200/80 sticky top-0 z-50 transition-all duration-300">
  <div class="max-w-7xl mx-auto px-3 sm:px-4">
    <div class="flex items-center justify-between h-14 sm:h-16">
      <!-- Logo dan Brand -->
      <div class="flex-shrink-0 z-10">
        <a href="/" class="flex items-center gap-2 sm:gap-3 text-gray-900 hover:scale-105 transition-transform duration-200">
          <Image src={logo} alt="EmitenHub Logo" width={300} height={60} format="webp" class="object-contain h-44" />
        </a>
      </div>

      <!-- Navigation Menu -->
      <nav class="hidden lg:flex items-center">
        <ul class="flex space-x-6 xl:space-x-8">
          <li>
            <a href="/" class="text-gray-700 hover:text-blue-600 font-medium text-sm py-2 px-1 relative transition-colors duration-200 after:absolute after:bottom-[-1rem] after:left-0 after:right-0 after:h-0.5 after:bg-gradient-to-r after:from-blue-600 after:to-blue-700 after:rounded-sm">
              Beranda
            </a>
          </li>
          <li>
            <a href="/categories/ekonomi" class="text-gray-700 hover:text-blue-600 font-medium text-sm py-2 px-1 transition-colors duration-200">
              Ekonomi
            </a>
          </li>
          <li>
            <a href="/categories/saham" class="text-gray-700 hover:text-blue-600 font-medium text-sm py-2 px-1 transition-colors duration-200">
              Saham
            </a>
          </li>
          <li>
            <a href="/categories/pasar" class="text-gray-700 hover:text-blue-600 font-medium text-sm py-2 px-1 transition-colors duration-200">
              Pasar
            </a>
          </li>
          <li>
            <a href="/categories/analisis" class="text-gray-700 hover:text-blue-600 font-medium text-sm py-2 px-1 transition-colors duration-200">
              Analisis
            </a>
          </li>
          <li>
            <a href="/categories/kripto" class="text-gray-700 hover:text-blue-600 font-medium text-sm py-2 px-1 transition-colors duration-200">
              Kripto
            </a>
          </li>
          <li>
            <a href="/categories/teknologi" class="text-gray-700 hover:text-blue-600 font-medium text-sm py-2 px-1 transition-colors duration-200">
              Teknologi
            </a>
          </li>
          <li>
            <a href="/underwriters" class="text-gray-700 hover:text-blue-600 font-medium text-sm py-2 px-1 transition-colors duration-200">
              History Underwriter IPO
            </a>
          </li>
        </ul>
      </nav>

      <!-- Search dan Actions -->
      <div class="flex items-center space-x-2 sm:space-x-4">
        <!-- Search Box -->
        <form action="/search" method="get" class="hidden md:block relative">
          <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 sm:w-5 sm:h-5 text-gray-400 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input 
            type="text" 
            name="q"
            id="search-input"
            placeholder="Cari berita..." 
            class="pl-9 sm:pl-10 pr-3 sm:pr-4 py-1.5 sm:py-2 w-32 sm:w-40 md:w-48 border border-gray-300 rounded-lg bg-gray-50 text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:bg-white transition-all duration-200"
          >
        </form>
        

        <!-- Mobile Menu Toggle -->
        <button 
          id="mobile-menu-toggle" 
          type="button" 
          class="lg:hidden relative z-[60] inline-flex items-center justify-center p-2.5 rounded-md text-gray-700 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 transition-all duration-200 min-w-[44px] min-h-[44px]"
          aria-label="Toggle mobile menu" 
          aria-expanded="false"
          aria-controls="mobile-menu"
        >
          <span class="sr-only">Open main menu</span>
          <!-- Hamburger Icon -->
          <div class="w-6 h-6 flex flex-col justify-center items-center space-y-1.5">
            <span id="hamburger-line-1" class="block w-5 h-0.5 bg-current transform transition-all duration-300 ease-in-out"></span>
            <span id="hamburger-line-2" class="block w-5 h-0.5 bg-current transform transition-all duration-300 ease-in-out"></span>
            <span id="hamburger-line-3" class="block w-5 h-0.5 bg-current transform transition-all duration-300 ease-in-out"></span>
          </div>
        </button>
      </div>
    </div>
  </div>
</header>

<!-- Mobile Menu Overlay -->
<div id="mobile-menu-overlay" class="lg:hidden fixed top-14 sm:top-16 left-0 right-0 bottom-0 bg-black/50 z-[55] hidden transition-opacity duration-300"></div>

<!-- Mobile Menu -->
<div class="lg:hidden fixed top-14 sm:top-16 left-0 right-0 bg-white border-b border-gray-200 hidden max-h-[calc(100vh-3.5rem)] overflow-y-auto z-[55] shadow-lg" id="mobile-menu">
  <div class="px-3 sm:px-4 py-3 space-y-0.5">
    <a href="/" class="block px-3 py-2.5 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-md text-sm font-medium transition-colors">Beranda</a>
    <a href="/categories/ekonomi" class="block px-3 py-2.5 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-md text-sm transition-colors">Ekonomi</a>
    <a href="/categories/saham" class="block px-3 py-2.5 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-md text-sm transition-colors">Saham</a>
    <a href="/categories/pasar" class="block px-3 py-2.5 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-md text-sm transition-colors">Pasar</a>
    <a href="/categories/analisis" class="block px-3 py-2.5 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-md text-sm transition-colors">Analisis</a>
    <a href="/categories/kripto" class="block px-3 py-2.5 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-md text-sm transition-colors">Kripto</a>
    <a href="/categories/teknologi" class="block px-3 py-2.5 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-md text-sm transition-colors">Teknologi</a>
    <a href="/underwriters" class="block px-3 py-2.5 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-md text-sm transition-colors">History Underwriter IPO</a>
    
    <!-- Mobile Search -->
    <div class="px-3 py-3 border-t border-gray-200 mt-2 pt-4">
      <form action="/search" method="get" class="relative">
        <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input 
          type="text" 
          name="q"
          id="mobile-search-input"
          placeholder="Cari berita..." 
          class="w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:bg-white transition-all duration-200"
        >
      </form>
    </div>
  </div>
</div>

<script is:inline>
  // Mobile menu toggle functionality
  (function() {
    'use strict';
    
    function initMobileMenu() {
      const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
      const mobileMenu = document.getElementById('mobile-menu');
      const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
      const line1 = document.getElementById('hamburger-line-1');
      const line2 = document.getElementById('hamburger-line-2');
      const line3 = document.getElementById('hamburger-line-3');
      
      if (!mobileMenuToggle || !mobileMenu || !mobileMenuOverlay) {
        console.warn('Mobile menu elements not found');
        return;
      }
      
      function openMenu() {
        mobileMenu.classList.remove('hidden');
        mobileMenuOverlay.classList.remove('hidden');
        mobileMenuToggle.setAttribute('aria-expanded', 'true');
        document.body.style.overflow = 'hidden';
        
        // Animate hamburger to X
        if (line1 && line2 && line3) {
          line1.style.transform = 'rotate(45deg) translate(5px, 5px)';
          line1.style.transformOrigin = 'center';
          line2.style.opacity = '0';
          line3.style.transform = 'rotate(-45deg) translate(7px, -6px)';
          line3.style.transformOrigin = 'center';
        }
      }
      
      function closeMenu() {
        mobileMenu.classList.add('hidden');
        mobileMenuOverlay.classList.add('hidden');
        mobileMenuToggle.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
        
        // Animate X back to hamburger
        if (line1 && line2 && line3) {
          line1.style.transform = '';
          line2.style.opacity = '1';
          line3.style.transform = '';
        }
      }
      
      function toggleMenu() {
        const isOpen = !mobileMenu.classList.contains('hidden');
        if (isOpen) {
          closeMenu();
        } else {
          openMenu();
        }
      }
      
      // Toggle button click
      mobileMenuToggle.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleMenu();
      });
      
      // Overlay click to close
      mobileMenuOverlay.addEventListener('click', function(e) {
        e.preventDefault();
        closeMenu();
      });
      
      // Close on menu link click
      const menuLinks = mobileMenu.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', function() {
          closeMenu();
        });
      });
      
      // Close on escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && !mobileMenu.classList.contains('hidden')) {
          closeMenu();
        }
      });
    }
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initMobileMenu);
    } else {
      initMobileMenu();
    }
  })();
  
  // Search form submit with Enter key
  (function() {
    'use strict';
    
    function initSearch() {
      const searchInput = document.getElementById('search-input');
      const mobileSearchInput = document.getElementById('mobile-search-input');
      
      if (searchInput) {
        searchInput.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' && this.value.trim()) {
            this.closest('form')?.submit();
          }
        });
      }

      if (mobileSearchInput) {
        mobileSearchInput.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' && this.value.trim()) {
            this.closest('form')?.submit();
          }
        });
      }
    }
    
    // Prefetch links on hover untuk faster navigation
    function initPrefetch() {
      const links = document.querySelectorAll('a[href^="/"]');
      links.forEach(link => {
        link.addEventListener('mouseenter', function() {
          const href = this.getAttribute('href');
          // Skip prefetch untuk link yang tidak valid atau external
          if (!href || href.startsWith('http') || href.startsWith('mailto:') || href.startsWith('tel:')) {
            return;
          }
          // Skip jika sudah ada prefetch link
          if (document.querySelector(`link[rel="prefetch"][href="${href}"]`)) {
            return;
          }
          // Prefetch hanya untuk internal links
          try {
            const prefetchLink = document.createElement('link');
            prefetchLink.rel = 'prefetch';
            prefetchLink.href = href;
            document.head.appendChild(prefetchLink);
          } catch (e) {
            // Silently fail jika ada error
            console.debug('Prefetch failed for:', href);
          }
        }, { once: true });
      });
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        initSearch();
        initPrefetch();
      });
    } else {
      initSearch();
      initPrefetch();
    }
  })();
</script>
