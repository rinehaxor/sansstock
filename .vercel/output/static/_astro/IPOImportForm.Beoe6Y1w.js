import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as m}from"./index.DMVOjPfi.js";import{z as l}from"./index.D6iQpRBa.js";function j(){const[d,o]=m.useState(""),[u,n]=m.useState(!1),[r,c]=m.useState(null),x=async t=>{t.preventDefault(),n(!0),c(null);try{const s=JSON.parse(d);if(!Array.isArray(s)){l.error("Data harus berupa array"),n(!1);return}const i=await fetch("/api/ipo-listings/import",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({data:s})}),a=await i.json();i.ok?(l.success(a.message||"Import berhasil"),c(a.results),o("")):(l.error(a.error||"Import gagal"),c(a))}catch(s){l.error("Error parsing JSON: "+(s instanceof Error?s.message:"Unknown error")),n(!1)}finally{n(!1)}},f=t=>{const s=t.target.files?.[0];if(!s)return;const i=new FileReader;i.onload=a=>{try{const p=a.target?.result;o(p),l.success("File berhasil dibaca")}catch{l.error("Error membaca file")}},i.readAsText(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"json-data",className:"block text-sm font-medium text-gray-700 mb-2",children:"Data JSON"}),e.jsx("textarea",{id:"json-data",rows:15,value:d,onChange:t=>o(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"Paste JSON data di sini atau upload file...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-gray-700 mb-2",children:"Atau Upload File JSON"}),e.jsx("input",{id:"file-upload",type:"file",accept:".json,.txt",onChange:f,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:u||!d.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Mengimport...":"Import Data"}),e.jsx("button",{type:"button",onClick:()=>o(""),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Clear"})]})]}),r&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Hasil Import"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-green-600",children:"Berhasil:"})," ",r.success]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-red-600",children:"Gagal:"})," ",r.failed]}),r.errors&&r.errors.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"font-medium text-red-600 mb-2",children:"Errors:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1 text-red-600",children:r.errors.map((t,s)=>e.jsx("li",{className:"text-xs",children:t},s))})]}),r.imported&&r.imported.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"font-medium text-green-600 mb-2",children:"Data yang diimport:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-green-600",children:[r.imported.slice(0,10).map((t,s)=>e.jsx("li",{className:"text-xs",children:t.ticker_symbol},s)),r.imported.length>10&&e.jsxs("li",{className:"text-xs",children:["... dan ",r.imported.length-10," lainnya"]})]})]})]})]})]})}export{j as default};
