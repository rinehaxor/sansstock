---
export const prerender = false;

import Layout from '../../layouts/Layout.astro';
import { supabase } from '../../db/supabase';
import UnderwriterComparison from '../../components/UnderwriterComparison.tsx';

// Fetch all underwriters for selection
const { data: underwriters, error } = await supabase
  .from('underwriters')
  .select('id, name')
  .order('name', { ascending: true });

if (error) {
  console.error('Error fetching underwriters:', error);
}

const underwritersList = underwriters || [];
---

<Layout 
	title="Analisis Performa Underwriter - EmitenHub"
	description="Analisis performa gabungan dari  underwriter IPO. Bandingkan performa ketika 1-3 underwriter bekerja sama menangani IPO."
	keywords="analisis underwriter,  underwriter, performa IPO, perbandingan underwriter, BEI, IHSG"
>
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
		<!-- Breadcrumb -->
		<div class="mb-6">
			<div class="flex items-center gap-2 text-sm text-gray-500">
				<a href="/" class="hover:text-gray-700">Beranda</a>
				<span>/</span>
				<a href="/underwriters" class="hover:text-gray-700">Underwriter IPO</a>
				<span>/</span>
				<span>Analisis Underwriter</span>
			</div>
		</div>

		<!-- Header -->
		<div class="mb-8">
			<h1 class="text-4xl font-bold text-gray-900 mb-2">Analisis Performa  Underwriter</h1>
			<p class="text-lg text-gray-600">
				Pilih satu atau lebih underwriter untuk melihat performa gabungan. Sistem akan menghitung rata-rata performa dari masing-masing underwriter, 
				lalu menggabungkannya menjadi satu nilai performa gabungan. Tidak perlu IPO yang sama, cukup rata-rata performa masing-masing.
			</p>
		</div>

		<!-- Info Box -->
		<div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8">
			<div class="flex items-start gap-3">
				<svg class="w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
				</svg>
				<div class="text-sm text-blue-800">
					<p class="font-medium mb-1">Cara Menggunakan:</p>
					<ul class="list-disc list-inside space-y-1 text-blue-700">
						<li>Klik "Tambah Underwriter" untuk menambah slot dropdown</li>
						<li>Pilih underwriter dari dropdown yang tersedia</li>
						<li>Indikator warna menunjukkan apakah performa bagus (hijau) atau kurang bagus (merah)</li>
					</ul>
				</div>
			</div>
		</div>

		<!-- Comparison Component -->
		<UnderwriterComparison 
			client:load
			underwriters={JSON.stringify(underwritersList)}
		/>
	</div>
</Layout>

