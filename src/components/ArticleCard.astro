---
import { Image } from 'astro:assets';

interface Props {
   title: string;
   excerpt: string;
   category: string;
   categoryColor: string;
   timeAgo: string;
   author?: string;
   authorInitials?: string;
   link: string;
   isLarge?: boolean;
   thumbnailUrl?: string | null;
   thumbnailAlt?: string | null;
   eagerLoad?: boolean;
   fetchPriority?: 'high' | 'low' | 'auto';
}

const {
   title,
   excerpt,
   category,
   categoryColor,
   timeAgo,
   author = 'Tim Editorial',
   authorInitials = 'TE',
   link,
   isLarge = false,
   thumbnailUrl,
   thumbnailAlt,
   eagerLoad = false,
   fetchPriority = 'auto',
} = Astro.props;
---

<article class={`rounded-lg border bg-white text-card-foreground shadow-md ${isLarge ? 'lg:col-span-2' : ''} group hover:shadow-lg transition-all duration-300 hover:-translate-y-1 overflow-hidden flex flex-col`}>
   {/* Image Header */}
   <div class={`w-full ${isLarge ? 'aspect-[21/9]' : 'aspect-[16/6.5]'} bg-gradient-to-br ${categoryColor} relative overflow-hidden flex-shrink-0`}>
      {thumbnailUrl ? (
         <>
            <Image 
               src={thumbnailUrl}
               alt={thumbnailAlt || title}
               width={isLarge ? 800 : 400}
               height={isLarge ? 343 : 225}
               class="w-full h-full object-cover object-center group-hover:scale-105 transition-transform duration-300"
               loading={isLarge || eagerLoad ? 'eager' : 'lazy'}
               fetchpriority={fetchPriority}
               format="webp"
               sizes={isLarge ? "(max-width: 768px) 100vw, 800px" : "(max-width: 640px) 100vw, 400px"}
            />
            <div class="absolute inset-0 bg-black/20"></div>
         </>
      ) : (
         <>
            <div class="absolute inset-0 bg-black/20"></div>
            {/* Icon */}
            <div class="absolute inset-0 flex items-center justify-center">
               <svg
                  width={isLarge ? '80' : '50'}
                  height={isLarge ? '80' : '50'}
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  class={`text-white/80 ${isLarge ? 'w-20 h-20 sm:w-24 sm:h-24' : 'w-10 h-10'}`}
               >
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <circle cx="8.5" cy="8.5" r="1.5"></circle>
                  <polyline points="21,15 16,10 5,21"></polyline>
               </svg>
            </div>
         </>
      )}
      <div class="absolute top-2 left-2 z-10">
         <span class="px-1.5 py-0.5 bg-white text-gray-800 hover:bg-white text-xs font-medium rounded-md">{category}</span>
      </div>
      <div class="absolute bottom-2 left-2 text-white z-10">
         <p class="text-xs opacity-90">{timeAgo}</p>
      </div>
   </div>

   {/* Content */}
   <div class={`flex flex-col flex-1 ${isLarge ? 'p-4 sm:p-5' : 'p-3'}`}>
      <h3 class={`${isLarge ? 'text-lg sm:text-xl md:text-2xl mb-2' : 'text-sm mb-1.5'} font-semibold tracking-tight leading-tight group-hover:text-blue-600 transition-colors line-clamp-2`}>{title}</h3>
      <p class={`${isLarge ? 'text-sm sm:text-base mb-3' : 'text-xs mb-2'} text-muted-foreground leading-relaxed line-clamp-2`}>{excerpt}</p>
      
      <div class="mt-auto flex items-center justify-between pt-2 border-t border-gray-100">
         <div class="flex items-center space-x-1.5">
            <div class={`${isLarge ? 'h-7 w-7' : 'h-5 w-5'} rounded-full bg-gray-200 flex items-center justify-center flex-shrink-0`}>
               <span class={`${isLarge ? 'text-xs' : 'text-[10px]'} font-medium text-gray-600`}>{authorInitials || 'A'}</span>
            </div>
            <div>
               <p class={`${isLarge ? 'text-xs' : 'text-[10px]'} font-medium leading-tight`}>{author || 'Tim Editorial'}</p>
               <p class={`${isLarge ? 'text-xs' : 'text-[10px]'} text-gray-500 leading-tight`}>EmitenHub</p>
            </div>
         </div>
         <a href={link} class={`text-blue-600 hover:text-blue-700 font-medium ${isLarge ? 'flex items-center group text-sm' : 'text-xs'}`}>
            {isLarge ? (
               <>
                  <span>Baca</span>
                  <svg class="w-3 h-3 ml-1 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
               </>
            ) : (
               'Baca â†’'
            )}
         </a>
      </div>
   </div>
</article>
