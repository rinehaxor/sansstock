import{j as r}from"./jsx-runtime.D_zvdyIk.js";import{r as u}from"./index.DMVOjPfi.js";import{D as y}from"./DataTable.BW11Mfvz.js";import{B as h}from"./Badge.BMvICgvW.js";import"./utils.CBfrqCZ4.js";import"./Input.BNCvmRV-.js";import"./index.3rXK4OIH.js";async function b(i,o){if(o>0){alert(`Kategori ini digunakan di ${o} artikel. Hapus kategori dari artikel terlebih dahulu sebelum menghapus kategori.`);return}if(confirm("Apakah Anda yakin ingin menghapus kategori ini?"))try{const s=await fetch(`/api/categories/${i}`,{method:"DELETE",credentials:"include"});if(s.ok)alert("Kategori berhasil dihapus"),window.location.reload();else{const t=await s.json();alert("Error: "+(t.error||"Gagal menghapus kategori"))}}catch{alert("Error: Gagal menghapus kategori")}}async function w(i,o){const s=i.filter(t=>(o[t]||0)>0);if(s.length>0){const t=s.map(l=>`Kategori ID ${l}`).join(", ");alert(`Beberapa kategori masih digunakan di artikel: ${t}. Hapus kategori dari artikel terlebih dahulu sebelum menghapus.`);return}try{const t=i.map(n=>fetch(`/api/categories/${n}`,{method:"DELETE",credentials:"include"})),c=(await Promise.all(t)).filter(n=>!n.ok);c.length===0?(alert(`${i.length} kategori berhasil dihapus`),window.location.reload()):alert(`${c.length} dari ${i.length} kategori gagal dihapus`)}catch{alert("Error: Gagal menghapus kategori")}}function $({categories:i,categoryUsage:o,currentPage:s,totalPages:t,totalItems:l,itemsPerPage:c,paginationBaseUrl:n,initialSearch:j=""}){const g=u.useMemo(()=>{try{return JSON.parse(i||"[]")}catch{return[]}},[i]),d=u.useMemo(()=>{try{return JSON.parse(o||"{}")}catch{return{}}},[o]),m=[{id:"name",header:"Name",accessorKey:"name",sortable:!0,cell:e=>r.jsx("div",{className:"font-semibold text-gray-900",children:e.name})},{id:"slug",header:"Slug",accessorKey:"slug",sortable:!0,cell:e=>r.jsx(h,{variant:"secondary",className:"font-mono text-xs",children:e.slug})},{id:"description",header:"Description",accessorKey:"description",cell:e=>r.jsx("div",{className:"text-sm text-gray-600 max-w-md truncate",children:e.description||"-"})},{id:"usage",header:"Usage",sortable:!0,cell:e=>{const a=d[e.id]||0;return r.jsxs(h,{variant:a>0?"default":"secondary",className:a>0?"bg-blue-100 text-blue-700":"",children:[a," artikel"]})}},{id:"created_at",header:"Created",accessorKey:"created_at",sortable:!0,cell:e=>r.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString("id-ID")})}],p=e=>{const a=d[e.id]||0;return[{label:"Edit",onClick:()=>{window.location.href=`/dashboard/categories/${e.id}/edit`},icon:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{label:"Delete",onClick:()=>{b(e.id,a)},icon:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}]},k=async e=>{const a=e.map(x=>x.id);await w(a,d)},f=e=>{if(n){const a=new URL(window.location.href);e?a.searchParams.set("search",e):a.searchParams.delete("search"),a.searchParams.set("page","1"),window.location.href=a.toString()}};return r.jsx(y,{data:g,columns:m,enableSelection:!0,actionMenuItems:p,onMassDelete:k,getRowId:e=>e.id,onSearch:f,searchPlaceholder:"Filter kategori...",emptyMessage:"Belum ada kategori. Buat kategori pertama untuk memulai.",defaultSort:{key:"created_at",direction:"desc"},currentPage:s,totalPages:t,totalItems:l,itemsPerPage:c,paginationBaseUrl:n})}export{$ as default};
